### 问题一的数学模型建立

#### 问题一所需的数据文件
1. **源域数据集文件**（共161个，示例：`SKF6205_DE_1797rpm_0.007inch.mat`等）：字段名称及含义：`time`（时域时间序列，单位：秒，维度1×N，N为采样点数）；`acceleration`（时域振动加速度信号，单位：g，维度1×N）；`bearing_type`（轴承类型，字符串，取值为"SKF6205"或"SKF6203"）；`fault_type`（故障类型，字符串，取值为"Healthy"（正常）、"Outer_Race"（外圈故障）、"Inner_Race"（内圈故障）、"Ball"（滚动体故障））；`fault_diameter`（故障点直径，单位：英寸，取值为0.007、0.014或0.021）；`rpm`（轴承转速，单位：转/分钟，取值为1000至3000之间的整数）。

2. **表格数据文件**：
   - `bearing_geometry_params.csv`：字段包括`bearing_type`（轴承类型，字符串，取值为"SKF6205"或"SKF6203"）、`n`（滚动体数，整数，SKF6205时为9，SKF6203时为9）、`d`（滚动体直径，单位：英寸，SKF6205时为0.3126，SKF6203时为0.2656）、`D`（轴承节径，单位：英寸，SKF6205时为1.537，SKF6203时为1.122）；
   - `fault_frequency_formula.csv`：字段包括`fault_name`（故障名称，字符串，取值为"Outer_Race"（外圈故障）、"Inner_Race"（内圈故障）、"Ball"（滚动体故障））、`frequency_formula`（特征频率公式，字符串，外圈故障为"f_r*(N_d/2)*(1-d/D)"，内圈故障为"f_r*(N_d/2)*(1+d/D)"，滚动体故障为"f_r*(D/d)*(1-(d/D)^2)"）。

#### 问题一的变量定义
- **源域数据集**：记为\( \mathcal{S} = \{s_1, s_2, ..., s_{161}\} \)，其中每个样本\( s_i \)包含以下属性：
  - \( t_i \)：时域时间序列，\( t_i \in [0, 4] \)（采样时长\( T=4 \)秒，对应字段`time`）；
  - \( a_i[k] \)：时域振动加速度离散信号（\( k=1,2,...,N \)，\( N=48000 \)，对应字段`acceleration`，\( a_i[k] = a_i(t_k) \)，\( t_k \)为第\( k \)个采样时刻）；
  - \( bt_i \)：轴承类型，\( bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \)（对应字段`bearing_type`）；
  - \( ft_i \)：故障类型，\( ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \)（对应字段`fault_type`）；
  - \( rpm_i \)：轴承转速，单位：转/分钟（对应字段`rpm`）；
  - \( f_{r,i} \)：轴承转速，单位：Hz，由\( rpm_i \)转换得到：\( f_{r,i} = \frac{rpm_i}{60} \)；
  - \( n_i \)：滚动体数，由\( bt_i \)查询`bearing_geometry_params.csv`得到（SKF6205时为9，SKF6203时为9）；
  - \( d_i \)：滚动体直径，单位：英寸，由\( bt_i \)查询`bearing_geometry_params.csv`得到（SKF6205时为0.3126，SKF6203时为0.2656）；
  - \( D_i \)：轴承节径，单位：英寸，由\( bt_i \)查询`bearing_geometry_params.csv`得到（SKF6205时为1.537，SKF6203时为1.122）；
  - \( fd_i \)：故障点直径，单位：英寸（对应字段`fault_diameter`，取值为0.007、0.014或0.021）。

#### 问题一的参数设置
- **数据筛选参数**：
  1. 轴承类型匹配：仅保留\( bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \)的样本（源域数据仅包含该两类轴承）；
  2. 故障类型覆盖：保留\( ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \)的样本（保证数据集包含所有故障类型）；
  3. 转速范围：保留\( rpm_i \in [1000, 3000] \)的样本（源域数据转速的有效取值范围）；
  4. 故障直径范围：保留\( fd_i \in \{0.007, 0.014, 0.021\} \)的样本（源域数据故障直径的有效取值）。

- **特征分析方法参数**：
  - 时域特征计算窗口：取完整采样时长\( T=4 \)秒（覆盖至少2个轴承旋转周期，确保捕捉故障冲击信号）；
  - FFT参数：采样频率\( F_s=12000 \)Hz（题目给定），采样点数\( N=48000 \)（\( N=F_s \times T \)），频率分辨率\( \Delta f = \frac{F_s}{N} = 0.25 \)Hz（足够分辨特征频率的谐波成分）；
  - EMD参数：选用经验模态分解（EMD）方法（自适应分解非线性非平稳信号，匹配轴承故障的振动特性），分解得到8个固有模态函数（IMF）（覆盖故障冲击的主要频率范围），舍弃最后1个趋势项（剩余分量为低频趋势，无故障诊断价值）。

#### 问题一的约束条件
1. **轴承几何参数约束**：滚动体数\( n_i \)、滚动体直径\( d_i \)、轴承节径\( D_i \)严格匹配`bearing_geometry_params.csv`中的参数（确保几何参数与轴承类型一致，是计算故障特征频率的基础）：\[
   \begin{cases}
   n_i=9, \ d_i=0.3126, \ D_i=1.537 & (bt_i=\text{SKF6205}) \\
   n_i=9, \ d_i=0.2656, \ D_i=1.122 & (bt_i=\text{SKF6203})
   \end{cases}
   \]

2. **故障特征频率约束**：基于`fault_frequency_formula.csv`的公式，计算理论特征频率（假设深沟球轴承接触角\( \alpha=0 \)，简化接触角对频率的影响，特征频率是故障诊断的核心标识）：\[
   \begin{cases}
   \text{BPFO}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 - \frac{d_i}{D_i}\right) \\
   \text{BPFI}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 + \frac{d_i}{D_i}\right) \\
   \text{BSF}*i = f*{r,i} \cdot \frac{D_i}{d_i} \left[ 1 - \left( \frac{d_i}{D_i} \right)^2 \right]
   \end{cases}
   \]其中\( f_{r,i} = \frac{rpm_i}{60} \)，\( n_i \)、\( d_i \)、\( D_i \)为轴承几何参数，\( rpm_i \)为轴承转速。

3. **特征提取约束**：
   - 时域特征约束：时域特征需基于完整4秒离散时间序列计算（确保覆盖完整的故障冲击周期）；
   - 频域特征约束：特征频率幅值为理论特征频率±1Hz范围内的最大幅值（实际信号因噪声或频率偏移，需扩大范围捕捉有效特征）；
   - 时频特征约束：EMD分解后各IMF能量占比需满足归一化条件（消除信号强度差异，聚焦频带分布），且选取前6个IMF（对应故障冲击的主要频带，排除高频噪声与低频趋势项）。

#### 问题一的完整数学模型公式

##### 1. 数据筛选模型（构建代表性数据集）
筛选满足源域数据属性约束的样本，确保数据集覆盖所有故障类型与参数范围，支撑后续迁移任务的泛化性：\[
\mathcal{S}' = \left\{ s_i \in \mathcal{S} \mid
\begin{aligned}
&bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \quad (\text{匹配源域轴承类型}) \\
&ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \quad (\text{覆盖所有故障类型}) \\
&rpm_i \in [1000, 3000] \quad (\text{源域转速有效范围}) \\
&fd_i \in \{0.007, 0.014, 0.021\} \quad (\text{源域故障直径有效范围})
\end{aligned}
\right\}
\]其中，\( \mathcal{S}' \)为筛选后的源域数据集，\( s_i \)为第\( i \)个源域样本，\( bt_i \)、\( ft_i \)、\( rpm_i \)、\( fd_i \)分别为样本的轴承类型、故障类型、转速、故障直径属性。

##### 2. 轴承几何参数计算模型（故障特征频率的基础输入）
基于`bearing_geometry_params.csv`文件，按轴承类型匹配滚动体数、滚动体直径、轴承节径（几何参数是故障特征频率的核心输入，直接决定频率计算结果）：\[
n_i =
\begin{cases}
9 & (bt_i = \text{SKF6205}) \\
9 & (bt_i = \text{SKF6203})
\end{cases}, \quad
d_i =
\begin{cases}
0.3126 & (bt_i = \text{SKF6205}) \\
0.2656 & (bt_i = \text{SKF6203})
\end{cases}, \quad
D_i =
\begin{cases}
1.537 & (bt_i = \text{SKF6205}) \\
1.122 & (bt_i = \text{SKF6203})
\end{cases}
\]其中，\( n_i \)为第\( i \)个样本的滚动体数（`bearing_geometry_params.csv`的`n`字段），\( d_i \)为滚动体直径（`d`字段），\( D_i \)为轴承节径（`D`字段）。

##### 3. 故障特征频率计算模型（故障的核心标识）
基于`fault_frequency_formula.csv`的公式，结合轴承几何参数与转速，计算每个样本的理论故障特征频率（反映故障部件的周期性冲击频率，是故障诊断的关键依据）：
- **外圈故障特征频率（BPFO）**：外圈故障时，滚动体与外圈故障点的碰撞频率：\[
  \text{BPFO}_i = \frac{rpm_i}{60} \cdot \frac{n_i}{2} \cdot \left(1 - \frac{d_i}{D_i}\right)
  \]其中，\( \frac{rpm_i}{60} \)将转速转换为Hz（单位时间内的旋转次数），\( \frac{n_i}{2} \)为滚动体与外圈接触的半周期数，\( 1 - \frac{d_i}{D_i} \)为外圈相对滚动体的运动系数。

- **内圈故障特征频率（BPFI）**：内圈故障时，滚动体与内圈故障点的碰撞频率：\[
  \text{BPFI}_i = \frac{rpm_i}{60} \cdot \frac{n_i}{2} \cdot \left(1 + \frac{d_i}{D_i}\right)
  \]其中，\( 1 + \frac{d_i}{D_i} \)为内圈相对滚动体的运动系数（内圈旋转方向与滚动体一致，系数大于1）。

- **滚动体故障特征频率（BSF）**：滚动体故障时，故障点与内外圈的碰撞频率：\[
  \text{BSF}_i = \frac{rpm_i}{60} \cdot \frac{D_i}{d_i} \cdot \left[ 1 - \left( \frac{d_i}{D_i} \right)^2 \right]
  \]其中，\( \frac{D_i}{d_i} \)为节径与滚动体直径的比值，\( 1 - \left( \frac{d_i}{D_i} \right)^2 \)为滚动体的自旋运动系数。

##### 4. 特征提取模型（量化故障特征）
结合轴承故障机理（冲击性、周期性），从时域、频域、时频域提取与故障强相关的特征，确保特征的可区分性：

###### （1）时域特征（反映信号的冲击与能量分布）
基于完整4秒离散振动加速度信号\( a_i[k] \)（\( k=1,2,...,48000 \)），提取以下指标：
1. **峰值（Peak）**：信号的最大绝对值，反映故障冲击的最大强度（故障信号因冲击会出现尖峰）：\[
   \text{Peak}*i = \max*{k=1}^{48000} |a_i[k]|
   \]其中，\( |a_i[k]| \)为第\( i \)个样本第\( k \)个采样点的振动加速度绝对值。

2. **均方根（RMS）**：信号的均方根值，反映信号的整体能量水平（故障信号能量通常高于正常信号）：\[
   \text{RMS}*i = \sqrt{\frac{1}{48000} \sum*{k=1}^{48000} a_i[k]^2}
   \]

3. **峰值因子（CrestFactor）**：峰值与RMS的比值，反映冲击成分的突变性（故障信号的峰值因子通常高于正常信号）：\[
   \text{CrestFactor}_i = \frac{\text{Peak}_i}{\text{RMS}_i}
   \]

4. **脉冲因子（ImpulseFactor）**：峰值与绝对均值的比值，反映脉冲成分的相对强度（故障信号的脉冲因子更突出）：\[
   \text{ImpulseFactor}_i = \frac{\text{Peak}*i}{\frac{1}{48000} \sum*{k=1}^{48000} |a_i[k]|}
   \]

5. **峭度（Kurtosis）**：信号的四阶标准化矩减3，反映信号的陡峭程度（故障信号因冲击成分，峭度大于0；正常信号峭度接近0）：\[
   \text{Kurtosis}*i = \frac{1}{48000} \sum*{k=1}^{48000} \left( \frac{a_i[k] - \mu_i}{\sigma_i} \right)^4 - 3
   \]其中，\( \mu_i = \frac{1}{48000} \sum_{k=1}^{48000} a_i[k] \)为第\( i \)个样本的时域信号均值，\( \sigma_i = \sqrt{\frac{1}{48000} \sum_{k=1}^{48000} (a_i[k] - \mu_i)^2} \)为标准差。

###### （2）频域特征（反映故障的周期性频率成分）
基于FFT变换结果\( A_i(f) = \text{FFT}\{a_i[k]\} \)（\( |A_i(f)| \)为频率\( f \)处的幅值），提取以下指标：
1. **特征频率幅值（F_f）**：针对样本的故障类型，提取理论特征频率±1Hz范围内的最大幅值（实际信号因噪声或频率偏移，需扩大范围捕捉有效特征）：\[
   F_{f,i}^{\text{FF}} = \max\left\{ |A_i(f)| \mid f \in [\text{FF}_i - 1, \text{FF}_i + 1] \right\}
   \]其中，\( \text{FF}_i \)为第\( i \)个样本的理论故障特征频率（若\( ft_i = \text{Outer_Race} \)，则\( \text{FF}_i = \text{BPFO}_i \)；若\( ft_i = \text{Inner_Race} \)，则\( \text{FF}_i = \text{BPFI}_i \)；若\( ft_i = \text{Ball} \)，则\( \text{FF}_i = \text{BSF}_i \)）。

2. **谐波总能量（E_harmonic）**：特征频率1~3次谐波的幅值之和，反映故障特征的谐波丰富度（故障信号的特征频率会产生明显的谐波）：\[
   E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{FF}_i)|
   \]

###### （3）时频特征（反映故障的频带分布）
采用经验模态分解（EMD）对\( a_i[k] \)进行分解，得到8个固有模态函数（IMF）\( \text{imf}*{j,i}[k] \)（\( j=1,2,...,8 \)），舍弃最后1个趋势项，计算前6个IMF的能量占比（归一化消除信号强度差异，聚焦故障冲击的主要频带）：\[
E*{j,i} = \sum_{k=1}^{48000} |\text{imf}*{j,i}[k]|^2, \quad j = 1,2,...,6
\]\[
E*{\text{total},i} = \sum_{j=1}^6 E_{j,i}
\]\[
F_{\text{emd},j,i} = \frac{E_{j,i}}{E_{\text{total},i}}, \quad j = 1,2,...,6
\]其中，\( \text{imf}*{j,i}[k] \)为第\( i \)个样本的第\( j \)个IMF分量（对应一个频率成分），\( E*{j,i} \)为第\( j \)个IMF的能量，\( E_{\text{total},i} \)为前6个IMF的总能量，\( F_{\text{emd},j,i} \)为第\( j \)个IMF的能量占比（反映故障冲击在不同频率段的分布）。

##### 5. 特征矩阵与选择模型（构建有效特征子集）
将提取的特征组合为特征向量，并通过ReliefF算法筛选区分能力最强的特征，降低维度并保留核心信息：

###### （1）特征矩阵（整合多域特征）
每个样本对应15维特征向量，涵盖时域、频域、时频域特征。健康样本（\( ft_i = \text{Healthy} \)）的故障特征频率幅值取所有特征频率幅值的最小值（健康样本无故障特征，这些值极小）：\[
\mathbf{f}*i = \left[ \text{Peak}*i, \text{RMS}*i, \text{CrestFactor}*i, \text{ImpulseFactor}*i, \text{Kurtosis}*i, F*{f,i}^{\text{BPFO}}, F*{f,i}^{\text{BPFI}}, F*{f,i}^{\text{BSF}}, E*{\text{harmonic},i}, F*{\text{emd},1,i}, F*{\text{emd},2,i}, F_{\text{emd},3,i}, F_{\text{emd},4,i}, F_{\text{emd},5,i}, F_{\text{emd},6,i} \right]^T
\]

###### （2）特征选择（ReliefF算法）
通过计算特征对样本类别的区分能力，筛选有效特征（参数设置：随机选取50个样本覆盖所有故障类型，每个样本选取5个同类/异类近邻平衡类内与类间差异）：
1. 初始化特征权重：\( W(f) = 0 \)，\( f = 1,2,...,15 \)（15维特征）。
2. 对每个随机选取的样本\( x_i \in \mathcal{S}' \)（共50个）：a. 找到\( k=5 \)个同类近邻\( x_{h,1},...,x_{h,5} \)（与\( x_i \)故障类型相同的样本中距离最近的5个）和\( k=5 \)个异类近邻\( x_{m,1},...,x_{m,5} \)（与\( x_i \)故障类型不同的样本中距离最近的5个）。b. 更新特征权重（权重增加类间差异、减少类内差异，反映特征的区分能力）：\[
   W(f) = W(f) - \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{h,l}(f)| + \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{m,l}(f)|
   \]其中，\( x_i(f) \)为样本\( x_i \)的第\( f \)维特征值，\( 1/(50×5) \)为权重更新的归一化系数（平均每个样本和每个近邻的贡献）。
3. 遍历所有50个样本后，按权重\( W(f) \)降序排序，选取前10个特征作为有效特征子集（保留区分能力最强的特征，支撑后续诊断任务）。

### 问题一的模型求解框架与完整内容

#### 一、问题一的模型求解算法介绍
问题一的核心是从源域数据中提取**可区分故障类型的多域特征**，并筛选有效特征支撑后续诊断任务。结合题目约束与轴承故障机理，推荐以下算法，其工作原理及与数学模型的适配性如下：

##### 1. 基于规则的数据筛选算法
- **原理**：遍历源域每个样本，验证其属性是否满足数学模型中**数据筛选约束**（轴承类型、故障类型、转速、故障直径的硬边界），保留符合所有条件的样本。
- **适配性**：直接对应数学模型中的**数据筛选模型**（\( \mathcal{S}' \)的定义），通过硬约束精准保留“代表性样本”，是后续分析的基础。

##### 2. 时域特征统计计算算法
- **原理**：对每个样本的4秒时域加速度信号，用统计公式计算**峰值、RMS、峰值因子、脉冲因子、峭度**，量化信号的冲击强度、能量水平与分布特征。
- **适配性**：完全匹配数学模型中的**时域特征提取模型**（5个时域特征的公式），直接反映轴承故障的“冲击性”核心机理。

##### 3. FFT频域特征计算算法
- **原理**：对时域信号做FFT得到频谱，结合**故障特征频率公式**计算理论频率，提取特征频率±1Hz内的最大幅值及1~3次谐波总能量，量化故障的“周期性频率标识”。
- **适配性**：对应数学模型中的**故障特征频率计算模型**与**频域特征提取模型**，通过“特征频率幅值”捕捉故障的核心频域指纹。

##### 4. EMD时频特征计算算法
- **原理**：用经验模态分解（EMD）对时域信号自适应分解为固有模态函数（IMF），每个IMF对应信号的一个频率分量；计算前6个IMF的能量占比，量化故障的“时间-频率”分布特征（EMD无需预设基函数，更适合轴承故障的非线性非平稳信号）。
- **适配性**：匹配修改后的**时频特征提取模型**，解决小波包需预设基函数的局限性，通过自适应分解聚焦故障冲击的主要频率分量，更贴合轴承故障的振动机理。

##### 5. ReliefF特征选择算法
- **原理**：通过“样本-近邻的特征差异”计算特征权重，筛选对故障类型区分能力最强的特征，剔除冗余信息。
- **适配性**：对应数学模型中的**特征选择模型**，通过权重更新公式量化特征的分类贡献，保留核心特征以支撑后续迁移任务。

#### 二、问题一的模型求解步骤
以下步骤严格对应数学模型中的**变量定义、约束条件、公式**，并明确每一步的输入、操作逻辑与输出，确保求解过程可复现。

##### 步骤1：源域数据加载与筛选（对应**数据筛选模型**）
- **输入**：161个源域.mat文件（含`time`、`acceleration`、`bearing_type`、`fault_type`、`fault_diameter`、`rpm`字段）、`bearing_geometry_params.csv`、`fault_frequency_formula.csv`。
- **操作**：
  1. 加载每个.mat文件，读取以下字段并映射至数学模型变量：
     - `time` → 时域时间序列\( t_i \)（维度1×N，N=48000，对应采样时长4秒）；
     - `acceleration` → 时域振动加速度信号\( a_i[k] \)（维度1×N，k=1,2,...,48000）；
     - `bearing_type` → 轴承类型\( bt_i \)；
     - `fault_type` → 故障类型\( ft_i \)；
     - `fault_diameter` → 故障点直径\( fd_i \)；
     - `rpm` → 轴承转速\( rpm_i \)。
  2. 验证每个样本的属性是否满足数学模型中的**数据筛选约束**：
     - \( bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \)（匹配源域轴承类型）；
     - \( ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \)（覆盖所有故障类型）；
     - \( rpm_i \in [1000, 3000] \)（源域转速有效范围）；
     - \( fd_i \in \{0.007, 0.014, 0.021\} \)（源域故障直径有效范围）。
  3. 保留所有满足上述条件的样本，形成筛选后的源域数据集\( \mathcal{S}' \)（对应数学模型中的\( \mathcal{S}' \)定义）。

##### 步骤2：样本属性补充计算（对应**轴承几何参数计算模型**）
- **输入**：筛选后的数据集\( \mathcal{S}' \)、`bearing_geometry_params.csv`。
- **操作**：对每个样本\( s_i \in \mathcal{S}' \)，补充以下属性（均对应数学模型中的变量定义）：
  1. 计算转速（Hz）：根据公式\( f_{r,i} = \frac{rpm_i}{60} \)，将转/分钟转换为赫兹（\( f_{r,i} \)为轴承旋转频率）。
  2. 补充轴承几何参数：根据\( bt_i \)查询`bearing_geometry_params.csv`，赋值：
     - 滚动体数\( n_i \)：若\( bt_i = \text{SKF6205} \)，则\( n_i=9 \)；若\( bt_i = \text{SKF6203} \)，则\( n_i=9 \)；
     - 滚动体直径\( d_i \)：若\( bt_i = \text{SKF6205} \)，则\( d_i=0.3126 \)英寸；若\( bt_i = \text{SKF6203} \)，则\( d_i=0.2656 \)英寸；
     - 轴承节径\( D_i \)：若\( bt_i = \text{SKF6205} \)，则\( D_i=1.537 \)英寸；若\( bt_i = \text{SKF6203} \)，则\( D_i=1.122 \)英寸。

##### 步骤3：时域特征计算（对应**时域特征提取模型**）
- **输入**：补充属性后的\( \mathcal{S}' \)、每个样本的\( a_i[k] \)（4秒离散信号，N=48000）。
- **操作**：对每个样本的\( a_i[k] \)，计算以下5个时域特征（均对应数学模型中的公式）：
  1. **峰值**：\( \text{Peak}*i = \max*{k=1}^{48000} |a_i[k]| \)，反映故障冲击的最大强度。
  2. **均方根**：\( \text{RMS}*i = \sqrt{\frac{1}{48000} \sum*{k=1}^{48000} a_i[k]^2} \)，反映信号整体能量水平。
  3. **峰值因子**：\( \text{CrestFactor}_i = \frac{\text{Peak}_i}{\text{RMS}_i} \)，反映冲击的突变性。
  4. **脉冲因子**：\( \text{ImpulseFactor}_i = \frac{\text{Peak}*i}{\frac{1}{48000} \sum*{k=1}^{48000} |a_i[k]|} \)，反映脉冲的相对强度。
  5. **峭度**：
     - 先计算均值：\( \mu_i = \frac{1}{48000} \sum_{k=1}^{48000} a_i[k] \)；
     - 再计算标准差：\( \sigma_i = \sqrt{\frac{1}{48000} \sum_{k=1}^{48000} (a_i[k] - \mu_i)^2} \)；
     - 最后计算峭度：\( \text{Kurtosis}*i = \frac{1}{48000} \sum*{k=1}^{48000} \left( \frac{a_i[k] - \mu_i}{\sigma_i} \right)^4 - 3 \)，反映信号分布的陡峭程度。

##### 步骤4：频域特征计算（对应**故障特征频率计算模型**与**频域特征提取模型**）
- **输入**：补充属性后的\( \mathcal{S}' \)、`fault_frequency_formula.csv`、每个样本的\( a_i[k] \)。
- **操作**：
  1. **理论故障频率计算**：根据样本的\( ft_i \)（故障类型），用`fault_frequency_formula.csv`中的公式计算（对应数学模型中的3个特征频率公式）：
     - 若\( ft_i = \text{Outer_Race} \)：\( \text{BPFO}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 - \frac{d_i}{D_i}\right) \)；
     - 若\( ft_i = \text{Inner_Race} \)：\( \text{BPFI}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 + \frac{d_i}{D_i}\right) \)；
     - 若\( ft_i = \text{Ball} \)：\( \text{BSF}*i = f*{r,i} \cdot \frac{D_i}{d_i} \cdot \left[ 1 - \left( \frac{d_i}{D_i} \right)^2 \right] \)；
     - 若\( ft_i = \text{Healthy} \)：理论特征频率取0（无故障）。
  2. **FFT变换**：对\( a_i[k] \)做FFT，得到频谱\( A_i(f) \)（\( |A_i(f)| \)为频率\( f \)处的幅值）。其中，采样频率\( F_s=12000 \)Hz（题目给定），采样点数\( N=48000 \)，频率分辨率\( \Delta f = \frac{F_s}{N} = 0.25 \)Hz（参数设置）。
  3. **特征频率幅值提取**：根据\( ft_i \)，提取理论特征频率±1Hz内的最大幅值（对应数学模型中的\( F_{f,i}^{\text{FF}} \)公式）：
     - 若\( ft_i = \text{Outer_Race} \)：\( F_{f,i}^{\text{BPFO}} = \max\left\{ |A_i(f)| \mid f \in [\text{BPFO}_i - 1, \text{BPFO}_i + 1] \right\} \)；
     - 若\( ft_i = \text{Inner_Race} \)：\( F_{f,i}^{\text{BPFI}} = \max\left\{ |A_i(f)| \mid f \in [\text{BPFI}_i - 1, \text{BPFI}_i + 1] \right\} \)；
     - 若\( ft_i = \text{Ball} \)：\( F_{f,i}^{\text{BSF}} = \max\left\{ |A_i(f)| \mid f \in [\text{BSF}_i - 1, \text{BSF}_i + 1] \right\} \)；
     - 若\( ft_i = \text{Healthy} \)：上述幅值取所有特征频率幅值的最小值（无故障特征）。
  4. **谐波总能量计算**：根据\( ft_i \)，计算特征频率1~3次谐波的幅值和（对应数学模型中的\( E_{\text{harmonic},i} \)公式）：
     - 若\( ft_i = \text{Outer_Race} \)：\( E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{BPFO}_i)| \)；
     - 若\( ft_i = \text{Inner_Race} \)：\( E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{BPFI}_i)| \)；
     - 若\( ft_i = \text{Ball} \)：\( E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{BSF}_i)| \)；
     - 若\( ft_i = \text{Healthy} \)：谐波总能量取0。

##### 步骤5：时频特征计算（对应**时频特征提取模型**）
- **输入**：补充属性后的\( \mathcal{S}' \)、每个样本的\( a_i[k] \)（4秒离散信号，N=48000）。
- **操作**：
  1. **EMD分解**：用经验模态分解（EMD）对\( a_i[k] \)进行分解，得到8个固有模态函数（IMF）\( \text{imf}_{j,i}[k] \)（\( j=1,2,...,8 \)）和1个趋势项（剩余分量），舍弃趋势项，保留前6个IMF（对应故障冲击的主要频带）。
  2. **IMF能量计算**：对每个\( j=1~6 \)，计算第\( j \)个IMF的能量：\( E_{j,i} = \sum_{k=1}^{48000} |\text{imf}_{j,i}[k]|^2 \)。
  3. **能量占比计算**：
     - 先计算前6个IMF的总能量：\( E_{\text{total},i} = \sum_{j=1}^6 E_{j,i} \)；
     - 再计算每个IMF的能量占比：\( F_{\text{emd},j,i} = \frac{E_{j,i}}{E_{\text{total},i}} \)，满足归一化约束\( \sum_{j=1}^6 F_{\text{emd},j,i} = 1 \)（时频特征约束）。

##### 步骤6：特征矩阵构建（对应**特征矩阵模型**）
- **输入**：每个样本的时域特征（5维）、频域特征（4维）、时频特征（6维）。
- **操作**：将每个样本的多域特征组合为15维特征向量（对应数学模型中的\( \mathbf{f}*i \)定义）：\[
  \mathbf{f}*i = \left[ \text{Peak}*i, \text{RMS}*i, \text{CrestFactor}*i, \text{ImpulseFactor}*i, \text{Kurtosis}*i, F*{f,i}^{\text{BPFO}}, F*{f,i}^{\text{BPFI}}, F*{f,i}^{\text{BSF}}, E*{\text{harmonic},i}, F*{\text{emd},1,i}, F*{\text{emd},2,i}, F*{\text{emd},3,i}, F_{\text{emd},4,i}, F_{\text{emd},5,i}, F_{\text{emd},6,i} \right]^T
  \]其中，健康样本（\( ft_i = \text{Healthy} \)）的故障特征频率幅值取所有特征频率幅值的最小值（无故障特征）。最终形成161×15的源域特征矩阵。

##### 步骤7：特征选择（对应**特征选择模型**）
- **输入**：源域特征矩阵、样本的\( ft_i \)（故障类型标签）。
- **操作**：用ReliefF算法筛选有效特征（参数设置：随机选50个样本覆盖所有故障类型，每个样本选5个同类/异类近邻）：
  1. **初始化权重**：对15维特征（f=1~15），设置\( W(f) = 0 \)。
  2. **随机选取样本**：从\( \mathcal{S}' \)中随机选50个样本，确保覆盖\( ft_i \)的所有取值（Healthy/Outer_Race/Inner_Race/Ball）。
  3. **寻找近邻**：对每个随机样本\( x_i \)，找到：
     - 5个**同类近邻**：与\( x_i \)故障类型相同、特征向量距离最近的5个样本（\( x_{h,1},...,x_{h,5} \)）；
     - 5个**异类近邻**：与\( x_i \)故障类型不同、特征向量距离最近的5个样本（\( x_{m,1},...,x_{m,5} \)）。
  4. **更新权重**：对每个特征f，用以下公式更新权重（对应数学模型中的权重更新公式）：\[
     W(f) = W(f) - \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{h,l}(f)| + \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{m,l}(f)|
     \]其中，\( 1/(50×5) \)是归一化系数（平均每个样本与近邻的贡献）。
  5. **筛选特征**：按权重\( W(f) \)降序排序，选取前10个特征作为**有效特征子集**（保留区分能力最强的特征）。

##### 步骤8：输出内容整理
根据问题一的要求，最终输出以下内容（对应数学模型的输出要求）：
1. **筛选后的源域数据集**：包含161个样本，保留`time`、`acceleration`、`bearing_type`、`fault_type`、`rpm`、`fault_diameter`字段，补充`f_r`（转速Hz）、`n`（滚动体数）、`d`（滚动体直径）、`D`（轴承节径）字段。
2. **代表性源域数据的特征分析结果**：
   - 时域特征对比：不同故障类型的`Peak`、`RMS`、`CrestFactor`、`ImpulseFactor`、`Kurtosis`的统计分布（如均值、方差、直方图）；
   - 频域特征对比：不同故障类型在`BPFO`、`BPFI`、`BSF`处的幅值分布；
   - 时频特征对比：不同故障类型的EMD时频图（展示IMF的能量分布与故障冲击的频率关联）。
3. **整体数据集的特征矩阵**：161×15的特征矩阵，每行对应一个样本的15维特征向量。
4. **特征选择结果**：通过ReliefF算法筛选出的有效特征子集（前10个高权重特征）。

以上步骤严格遵循数学模型的**输入约束**与**输出要求**，算法与模型完全适配，逻辑连贯且细节完备，为后续代码实现提供了精准的执行指引。
