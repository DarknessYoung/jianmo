### 问题一的数学模型建立与求解

问题一的核心是从源域轴承振动数据中提取**可区分故障类型的多域特征**，并筛选有效特征以支撑后续跨域故障诊断的迁移任务。源域数据包含两类轴承（SKF6205、SKF6203）的正常与三类故障（外圈、内圈、滚动体）数据，需通过特征提取将原始振动信号转化为故障敏感的量化指标。

### 问题一的完整数学模型建立

#### 1. 变量定义
为精准描述源域数据的属性与特征，定义以下变量（所有变量均基于源域数据集的物理属性与故障诊断需求）：
- **源域数据集**：记为\( \mathcal{S} = \{s_1, s_2, ..., s_{161}\} \)，其中每个样本\( s_i \)对应一个轴承运行状态的振动信号采集记录。
- **时域时间序列**：\( t_i \in [0, 4] \)（单位：秒），对应样本\( s_i \)的采样时长（题目规定为4秒），离散化为\( t_k = \frac{k-1}{F_s} \)（\( k=1,2,...,N \)），其中\( F_s=12000 \)Hz（题目给定采样频率），故采样点数\( N=F_s \times 4=48000 \)。
- **离散振动加速度**：\( a_i[k] \in \mathbb{R} \)（单位：g），对应样本\( s_i \)在第\( k \)个采样时刻的振动加速度值，即\( a_i[k] = a_i(t_k) \)，是原始信号的离散化表示（直接反映轴承运行的振动强度）。
- **轴承类型**：\( bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \)，标识样本对应的轴承型号（源域仅含此两类）。
- **故障类型**：\( ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \)，标识样本的故障状态（正常或三类故障）。
- **转速（转/分钟）**：\( rpm_i \in [1000, 3000] \)，对应轴承的运行转速（源域有效范围）。
- **转速（赫兹）**：\( f_{r,i} = \frac{rpm_i}{60} \)（单位：Hz），将转速从“转/分钟”转换为“每秒旋转次数”，是计算故障特征频率的基础。
- **滚动体数**：\( n_i \in \{9\} \)，由轴承类型\( bt_i \)查询表格数据得到（两类轴承的滚动体数均为9，制造商固定参数）。
- **滚动体直径**：\( d_i \in \{0.3126, 0.2656\} \)（单位：英寸），由轴承类型\( bt_i \)查询表格数据得到（SKF6205为0.3126，SKF6203为0.2656）。
- **轴承节径**：\( D_i \in \{1.537, 1.122\} \)（单位：英寸），由轴承类型\( bt_i \)查询表格数据得到（SKF6205为1.537，SKF6203为1.122），表示滚动体中心的圆周直径（几何参数核心）。
- **故障点直径**：\( fd_i \in \{0.007, 0.014, 0.021\} \)（单位：英寸），标识故障点的物理尺寸（源域有效范围）。

#### 2. 参数设置
为保证特征提取的有效性与一致性，设置以下参数（所有参数均基于轴承故障诊断的机理与题目约束）：
- **时域特征窗口**：取完整采样时长\( T=4 \)秒，对应离散点数\( N=48000 \)。此设置的依据是：轴承故障的冲击信号具有周期性，4秒可覆盖至少2个旋转周期（如转速1000rpm时，旋转周期为0.06秒，4秒含约66个周期），确保捕捉完整的冲击模式。
- **FFT参数**：采样频率\( F_s=12000 \)Hz（题目给定），采样点数\( N=48000 \)，故频率分辨率\( \Delta f = \frac{F_s}{N}=0.25 \)Hz（足够分辨特征频率的谐波成分，如100Hz的特征频率其谐波间隔为100Hz，0.25Hz的分辨率可精准定位）。
- **EMD参数**：分解得到8个固有模态函数（IMF），舍弃最后1个趋势项（低频分量，无故障信息），保留前6个IMF（对应故障冲击的主要频带：高频冲击→中频调制→低频趋势，前6个IMF覆盖冲击的核心频率范围）。

#### 3. 模型假设
为简化计算并聚焦核心故障机理，提出以下假设（均基于轴承故障诊断的工程实践与题目约束）：
- **假设1**：深沟球轴承的接触角\( \alpha=0 \)。依据：深沟球轴承的接触角通常≤15°，对特征频率的影响（公式中为\( \cos\alpha \)）可忽略（\( \cos0°=1 \)），简化后特征频率的计算误差≤5%，满足工程精度要求。
- **假设2**：源域数据的采样频率准确。依据：题目明确给定采样频率\( F_s=12000 \)Hz，无需额外校准，保证离散信号与连续信号的时间对应关系。
- **假设3**：故障直径的影响通过归一化处理消除。依据：不同故障直径（0.007、0.014、0.021英寸）会影响冲击强度，但通过能量占比、峰值因子等归一化特征，可聚焦频率分布而非绝对强度，避免直径差异对特征区分的干扰。

#### 4. 约束条件
特征提取与模型推导需满足以下约束（均为故障诊断的必要条件，确保特征的有效性与可解释性）：
- **轴承几何参数约束**：滚动体数\( n_i \)、滚动体直径\( d_i \)、轴承节径\( D_i \)必须与轴承类型严格匹配（来自制造商的几何参数表），即：\[
  \begin{cases}
  n_i=9, \ d_i=0.3126, \ D_i=1.537 & (bt_i=\text{SKF6205}) \\
  n_i=9, \ d_i=0.2656, \ D_i=1.122 & (bt_i=\text{SKF6203})
  \end{cases}
  \]该约束是计算故障特征频率的基础——几何参数直接决定特征频率的数值，若不匹配会导致频率计算错误，无法识别故障。

- **故障特征频率约束**：基于故障类型的特征频率必须由几何参数与转速推导得到（来自故障频率公式表），即：\[
  \begin{cases}
  \text{BPFO}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 - \frac{d_i}{D_i}\right) \\
  \text{BPFI}*i = f*{r,i} \cdot \frac{n_i}{2} \cdot \left(1 + \frac{d_i}{D_i}\right) \\
  \text{BSF}*i = f*{r,i} \cdot \frac{D_i}{d_i} \cdot \left[ 1 - \left( \frac{d_i}{D_i} \right)^2 \right]
  \end{cases}
  \]其中\( f_{r,i} = \frac{rpm_i}{60} \)（转速转换为Hz）。该约束是故障诊断的“核心标识”——不同故障类型对应唯一的特征频率，如外圈故障对应BPFO，内圈对应BPFI，滚动体对应BSF，是区分故障类型的关键依据。

- **特征提取约束**：
  1. **时域特征约束**：时域特征必须基于完整4秒离散信号计算，即：\[
     \text{特征值} = \mathcal{F}(a_i[1], a_i[2], ..., a_i[48000])
     \]其中\( \mathcal{F} \)为统计函数（如最大值、均方根）。该约束确保时域特征覆盖完整的冲击周期，避免因窗口过短导致的特征缺失。
  2. **频域特征约束**：特征频率幅值必须取理论特征频率±1Hz范围内的最大值，即：\[
     F_{f,i}^{\text{FF}} = \max\left\{ |A_i(f)| \mid f \in [\text{FF}_i - 1, \text{FF}_i + 1] \right\}
     \]其中\( A_i(f) \)为\( a_i[k] \)的FFT频谱，\( \text{FF}_i \)为理论特征频率（如BPFO）。该约束应对实际信号的噪声与频率偏移——由于轴承安装误差、负载波动，实际特征频率可能偏离理论值，扩大范围可捕捉有效特征。
  3. **时频特征约束**：EMD分解后的IMF能量占比必须归一化，即：\[
     \sum_{j=1}^6 F_{\text{emd},j,i} = 1
     \]其中\( F_{\text{emd},j,i} = \frac{E_{j,i}}{E_{\text{total},i}} \)（\( E_{j,i} \)为第\( j \)个IMF的能量，\( E_{\text{total},i} \)为前6个IMF的总能量）。该约束消除信号强度差异，聚焦故障冲击的频带分布（如外圈故障的冲击主要集中在高频IMF，内圈故障集中在中频）。

#### 5. 完整数学模型公式
特征提取的核心是将原始振动信号转化为**故障敏感的量化指标**，需从时域、频域、时频域多维度构建特征，形成“冲击强度→频率标识→频带分布”的完整特征链。

##### （1）数据筛选模型：构建代表性数据集
源域数据需覆盖所有故障类型与参数范围，以支撑后续迁移任务的泛化性。筛选满足属性约束的样本，定义筛选后的数据集：\[
\mathcal{S}' = \left\{ s_i \in \mathcal{S} \mid
\begin{aligned}
&bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \\
&ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \\
&rpm_i \in [1000, 3000] \\
&fd_i \in \{0.007, 0.014, 0.021\}
\end{aligned}
\right\}
\]**解释**：该公式通过硬约束保留“代表性样本”——轴承类型匹配源域、故障类型覆盖所有情况、转速与故障直径在有效范围，确保后续分析的样本具有多样性与典型性。

##### （2）轴承几何参数计算模型：特征频率的基础输入
特征频率需轴承几何参数（\( n_i, d_i, D_i \)），这些参数由轴承类型唯一确定（来自制造商数据），公式为：\[
n_i =
\begin{cases}
9 & (bt_i = \text{SKF6205}) \\
9 & (bt_i = \text{SKF6203})
\end{cases}, \quad
d_i =
\begin{cases}
0.3126 & (bt_i = \text{SKF6205}) \\
0.2656 & (bt_i = \text{SKF6203})
\end{cases}, \quad
D_i =
\begin{cases}
1.537 & (bt_i = \text{SKF6205}) \\
1.122 & (bt_i = \text{SKF6203})
\end{cases}
\]**解释**：几何参数是特征频率的核心输入（如BPFO公式中的\( n_i, d_i, D_i \)），必须与轴承类型严格匹配——若SKF6205的滚动体数取为8，特征频率的计算误差将超过20%，导致故障误判。

##### （3）故障特征频率计算模型：故障的核心标识
基于几何参数与转速，计算每个样本的理论特征频率（对应故障类型）：
- **外圈故障（Outer_Race）**：滚动体与外圈故障点的碰撞频率（BPFO）：\[
  \text{BPFO}_i = \frac{rpm_i}{60} \cdot \frac{n_i}{2} \cdot \left(1 - \frac{d_i}{D_i}\right)
  \]**解释**：\( \frac{rpm_i}{60} \)将转速转换为每秒旋转次数（Hz）；\( \frac{n_i}{2} \)是滚动体与外圈接触的半周期数（每个滚动体每转一圈与外圈接触两次）；\( 1 - \frac{d_i}{D_i} \)是外圈相对滚动体的运动系数（外圈固定，滚动体绕外圈转动的相对速度比例）。例如，SKF6205轴承（\( n=9, d=0.3126, D=1.537 \)）、转速1797rpm时，\( \text{BPFO}_i = \frac{1797}{60} \cdot \frac{9}{2} \cdot (1 - \frac{0.3126}{1.537}) ≈ 29.95 \cdot 4.5 \cdot 0.797 ≈ 107 \)Hz，此频率是外圈故障的“指纹”。

- **内圈故障（Inner_Race）**：滚动体与内圈故障点的碰撞频率（BPFI）：\[
  \text{BPFI}_i = \frac{rpm_i}{60} \cdot \frac{n_i}{2} \cdot \left(1 + \frac{d_i}{D_i}\right)
  \]**解释**：与BPFO的差异在于运动系数为\( 1 + \frac{d_i}{D_i} \)——内圈随轴旋转（方向与滚动体一致），相对速度更大，故BPFI > BPFO。例如，同参数下，\( \text{BPFI}_i ≈ 29.95 \cdot 4.5 \cdot 1.203 ≈ 162 \)Hz，是内圈故障的标识。

- **滚动体故障（Ball）**：滚动体故障点与内外圈的碰撞频率（BSF）：\[
  \text{BSF}_i = \frac{rpm_i}{60} \cdot \frac{D_i}{d_i} \cdot \left[ 1 - \left( \frac{d_i}{D_i} \right)^2 \right]
  \]**解释**：\( \frac{D_i}{d_i} \)是节径与滚动体直径的比值，反映滚动体的自旋速度；\( 1 - \left( \frac{d_i}{D_i} \right)^2 \)是自旋运动系数（滚动体绕自身轴线旋转的速度比例）。例如，同参数下，\( \text{BSF}_i ≈ 29.95 \cdot \frac{1.537}{0.3126} \cdot (1 - 0.041) ≈ 29.95 \cdot 4.917 \cdot 0.959 ≈ 142 \)Hz，是滚动体故障的标识。

##### （4）时域特征提取模型：量化冲击强度
时域特征直接反映振动信号的冲击性（故障的核心机理），计算以下5个统计量：
- **峰值（Peak）**：信号的最大绝对值，反映故障冲击的最大强度（故障信号因冲击会出现尖峰）：\[
  \text{Peak}*i = \max*{k=1}^{48000} |a_i[k]|
  \]**解释**：正常信号的峰值较小（无冲击），故障信号的峰值显著增大（如外圈故障时，滚动体碰撞故障点产生尖峰）。

- **均方根（RMS）**：信号的均方根值，反映信号的整体能量水平（故障信号能量高于正常信号）：\[
  \text{RMS}*i = \sqrt{\frac{1}{48000} \sum*{k=1}^{48000} a_i[k]^2}
  \]**解释**：RMS是能量的量化指标，故障时轴承摩擦加剧，振动能量增加，RMS值升高。

- **峰值因子（CrestFactor）**：峰值与RMS的比值，反映冲击成分的突变性（故障信号的峰值因子更高）：\[
  \text{CrestFactor}_i = \frac{\text{Peak}_i}{\text{RMS}_i}
  \]**解释**：正常信号的峰值因子约为3（高斯分布），故障信号因尖峰突出，峰值因子可升至5以上（如滚动体故障时，冲击的突变性更强）。

- **脉冲因子（ImpulseFactor）**：峰值与绝对均值的比值，反映脉冲成分的相对强度：\[
  \text{ImpulseFactor}_i = \frac{\text{Peak}*i}{\frac{1}{48000} \sum*{k=1}^{48000} |a_i[k]|}
  \]**解释**：绝对均值反映信号的平均强度，脉冲因子聚焦“峰值与平均强度的差异”——故障信号的脉冲因子更大（冲击的相对强度更高）。

- **峭度（Kurtosis）**：信号的四阶标准化矩减3，反映信号的陡峭程度（故障信号的峭度大于0）：\[
  \text{Kurtosis}*i = \frac{1}{48000} \sum*{k=1}^{48000} \left( \frac{a_i[k] - \mu_i}{\sigma_i} \right)^4 - 3
  \]其中，\( \mu_i = \frac{1}{48000} \sum_{k=1}^{48000} a_i[k] \)（时域均值），\( \sigma_i = \sqrt{\frac{1}{48000} \sum_{k=1}^{48000} (a_i[k] - \mu_i)^2} \)（时域标准差）。**解释**：正常信号服从高斯分布，峭度约为0；故障信号因冲击成分（尖峰），峭度显著大于0（如内圈故障时，峭度可升至2以上）。

##### （5）频域特征提取模型：量化频率标识
频域特征捕捉故障的周期性频率成分（特征频率是故障的“指纹”），计算以下2个指标：
- **特征频率幅值**：理论特征频率±1Hz范围内的最大幅值（应对实际信号的频率偏移）：\[
  F_{f,i}^{\text{FF}} = \max\left\{ |A_i(f)| \mid f \in [\text{FF}_i - 1, \text{FF}_i + 1] \right\}
  \]其中，\( A_i(f) = \text{FFT}\{a_i[k]\} \)是\( a_i[k] \)的快速傅里叶变换频谱（反映信号的频率分布），\( \text{FF}_i \)为理论特征频率（如BPFO）。**解释**：实际信号受噪声、安装误差影响，特征频率可能偏离理论值（如理论BPFO为107Hz，实际可能为106.5Hz），扩大范围至±1Hz可确保捕捉有效幅值。

- **谐波总能量**：特征频率1~3次谐波的幅值之和（反映故障特征的谐波丰富度）：\[
  E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{FF}_i)|
  \]**解释**：故障冲击是周期性的，会激发特征频率的谐波（如BPFO=107Hz时，谐波为214Hz、321Hz），谐波越丰富，故障越明显（正常信号的谐波能量极低）。

##### （6）时频特征提取模型：量化频带分布
时频特征反映故障冲击的频率-时间分布（EMD自适应分解非线性非平稳信号），计算步骤如下：
1. **EMD分解**：将\( a_i[k] \)分解为8个固有模态函数（IMF）\( \text{imf}_{j,i}[k] \)（\( j=1,2,...,8 \)），每个IMF对应一个窄带频率分量（从高频到低频排序）。
2. **IMF能量计算**：计算前6个IMF的能量（舍弃最后1个趋势项，无故障信息）：\[
   E_{j,i} = \sum_{k=1}^{48000} |\text{imf}_{j,i}[k]|^2 \quad (j=1,2,...,6)
   \]
3. **能量占比归一化**：计算每个IMF的能量占比（消除信号强度差异，聚焦频带分布）：\[
   F_{\text{emd},j,i} = \frac{E_{j,i}}{\sum_{m=1}^6 E_{m,i}} \quad (j=1,2,...,6)
   \]**解释**：不同故障类型的冲击频带不同——外圈故障的冲击主要集中在高频IMF（如\( j=1,2 \)），内圈故障集中在中频IMF（如\( j=3,4 \)），滚动体故障集中在中高频IMF（如\( j=2,3 \)）。能量占比可量化这种频带差异，是故障区分的重要依据。

##### （7）特征矩阵与选择模型：构建有效特征子集
将多域特征组合为向量，并筛选区分能力最强的特征（降低维度，避免过拟合）：
- **特征矩阵**：每个样本对应15维特征向量（5时域+4频域+6时频），健康样本的故障特征频率幅值取所有特征频率幅值的最小值（无故障特征，值极小）：\[
  \mathbf{f}*i = \left[ \text{Peak}*i, \text{RMS}*i, \text{CrestFactor}*i, \text{ImpulseFactor}*i, \text{Kurtosis}*i, F*{f,i}^{\text{BPFO}}, F*{f,i}^{\text{BPFI}}, F*{f,i}^{\text{BSF}}, E*{\text{harmonic},i}, F*{\text{emd},1,i}, F*{\text{emd},2,i}, F_{\text{emd},3,i}, F_{\text{emd},4,i}, F_{\text{emd},5,i}, F_{\text{emd},6,i} \right]^T
  \]**解释**：多域特征整合了冲击强度、频率标识、频带分布，全面反映故障特性。

- **ReliefF特征选择**：通过样本与近邻的特征差异计算权重，筛选前10个高权重特征（区分能力最强）：
  1. 初始化权重：\( W(f)=0 \)（\( f=1,2,...,15 \)，对应15维特征）。
  2. 随机选取50个样本（覆盖所有故障类型），对每个样本\( x_i \)：a. 找5个同类近邻\( x_{h,1},...,x_{h,5} \)（与\( x_i \)故障类型相同的样本中距离最近的5个）和5个异类近邻\( x_{m,1},...,x_{m,5} \)（与\( x_i \)故障类型不同的样本中距离最近的5个）。b. 更新特征权重（权重增加类间差异、减少类内差异，反映特征的区分能力）：\[
     W(f) = W(f) - \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{h,l}(f)| + \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{m,l}(f)|
     \]
  3. 遍历所有50个样本后，按权重\( W(f) \)降序排序，选取前10个特征作为有效特征子集。**解释**：\( \frac{1}{50 \times 5} \)是归一化系数（平均每个样本与近邻的贡献）；权重\( W(f) \)越高，说明特征对故障类型的区分能力越强（类间差异大、类内差异小）。

### 问题一的模型求解算法介绍

问题一的核心是**将原始振动信号转化为故障敏感特征**，需通过以下算法实现（均与数学模型严格适配）：

#### 1. 基于规则的数据筛选算法
- **原理**：遍历源域每个样本，验证其属性是否满足轴承类型、故障类型、转速、故障直径的约束（硬边界条件），保留符合所有条件的样本。
- **核心逻辑**：\[
  s_i \in \mathcal{S}' \iff (bt_i \in \{\text{SKF6205}, \text{SKF6203}\}) \land (ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\}) \land (rpm_i \in [1000, 3000]) \land (fd_i \in \{0.007, 0.014, 0.021\})
  \]
- **适配性**：直接对应数据筛选模型（\( \mathcal{S}' \)的定义），确保后续分析的样本具有代表性。

#### 2. 时域特征统计计算算法
- **原理**：对每个样本的4秒时域信号，用统计公式计算峰值、RMS、峰值因子、脉冲因子、峭度，量化信号的冲击强度与能量分布。
- **核心公式**：时域特征的5个统计公式（见“时域特征提取模型”）。
- **适配性**：完全匹配时域特征提取模型，直接反映轴承故障的“冲击性”机理。

#### 3. FFT频域特征计算算法
- **原理**：通过快速傅里叶变换（FFT）将时域信号转换为频域频谱，结合理论特征频率提取幅值与谐波能量，量化故障的“频率标识”。
- **核心公式**：
  1. FFT变换：\( A_i(f) = \text{FFT}\{a_i[k]\} \)；
  2. 特征频率幅值：\( F_{f,i}^{\text{FF}} = \max\left\{ |A_i(f)| \mid f \in [\text{FF}_i - 1, \text{FF}_i + 1] \right\} \)；
  3. 谐波总能量：\( E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{FF}_i)| \)。
- **适配性**：对应故障特征频率计算模型与频域特征提取模型，捕捉故障的核心频域指纹。

#### 4. EMD时频特征计算算法
- **原理**：用经验模态分解（EMD）对时域信号自适应分解为IMF（无需预设基函数），计算前6个IMF的能量占比，量化故障的“时频分布”。
- **核心公式**：
  1. IMF能量：\( E_{j,i} = \sum_{k=1}^{48000} |\text{imf}_{j,i}[k]|^2 \)；
  2. 能量占比：\( F_{\text{emd},j,i} = \frac{E_{j,i}}{\sum_{m=1}^6 E_{m,i}} \)。
- **适配性**：匹配时频特征提取模型，解决小波包需预设基函数的局限性，自适应聚焦故障冲击的频带。

#### 5. ReliefF特征选择算法
- **原理**：通过计算“样本-近邻的特征差异”量化特征的区分能力，权重高的特征对故障类型的区分贡献大。
- **核心公式**：权重更新公式（见“特征选择模型”）：\[
  W(f) = W(f) - \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{h,l}(f)| + \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{m,l}(f)|
  \]
- **适配性**：对应特征选择模型，筛选有效特征以降低维度，支撑后续迁移任务的泛化性。

### 问题一的模型求解步骤

以下步骤严格对应数学模型的约束与公式，确保求解过程可复现：

#### 步骤1：源域数据加载与筛选（对应数据筛选模型）
- **输入**：161个源域.mat文件（含`time`、`acceleration`、`bearing_type`、`fault_type`、`fault_diameter`、`rpm`字段）、`bearing_geometry_params.csv`、`fault_frequency_formula.csv`。
- **操作**：
  1. 加载每个.mat文件，将字段映射至变量：\( time→t_i \)、\( acceleration→a_i[k] \)、\( bearing_type→bt_i \)、\( fault_type→ft_i \)、\( fault_diameter→fd_i \)、\( rpm→rpm_i \)。
  2. 验证样本属性是否满足约束：\( bt_i \in \{\text{SKF6205}, \text{SKF6203}\} \)、\( ft_i \in \{\text{Healthy}, \text{Outer_Race}, \text{Inner_Race}, \text{Ball}\} \)、\( rpm_i \in [1000, 3000] \)、\( fd_i \in \{0.007, 0.014, 0.021\} \)。
  3. 保留符合条件的样本，形成筛选后的数据集\( \mathcal{S}' \)。

#### 步骤2：样本属性补充计算（对应轴承几何参数模型）
- **输入**：筛选后的数据集\( \mathcal{S}' \)、`bearing_geometry_params.csv`。
- **操作**：
  1. 计算转速（Hz）：\( f_{r,i} = \frac{rpm_i}{60} \)。
  2. 补充几何参数：根据\( bt_i \)查询表格，赋值\( n_i \)、\( d_i \)、\( D_i \)（如\( bt_i=\text{SKF6205} \)时，\( n_i=9 \)、\( d_i=0.3126 \)、\( D_i=1.537 \)）。

#### 步骤3：时域特征计算（对应时域特征提取模型）
- **输入**：补充属性后的\( \mathcal{S}' \)、每个样本的\( a_i[k] \)。
- **操作**：对每个样本的\( a_i[k] \)，计算5个时域特征：
  1. 峰值：\( \text{Peak}*i = \max*{k=1}^{48000} |a_i[k]| \)；
  2. RMS：\( \text{RMS}*i = \sqrt{\frac{1}{48000} \sum*{k=1}^{48000} a_i[k]^2} \)；
  3. 峰值因子：\( \text{CrestFactor}_i = \frac{\text{Peak}_i}{\text{RMS}_i} \)；
  4. 脉冲因子：\( \text{ImpulseFactor}_i = \frac{\text{Peak}*i}{\frac{1}{48000} \sum*{k=1}^{48000} |a_i[k]|} \)；
  5. 峭度：先算均值\( \mu_i \)、标准差\( \sigma_i \)，再算\( \text{Kurtosis}*i = \frac{1}{48000} \sum*{k=1}^{48000} \left( \frac{a_i[k] - \mu_i}{\sigma_i} \right)^4 - 3 \)。

#### 步骤4：频域特征计算（对应故障特征频率与频域特征模型）
- **输入**：补充属性后的\( \mathcal{S}' \)、每个样本的\( a_i[k] \)。
- **操作**：
  1. 计算理论特征频率：根据\( ft_i \)，计算\( \text{BPFO}_i \)（外圈故障）、\( \text{BPFI}_i \)（内圈故障）或\( \text{BSF}_i \)（滚动体故障），健康样本取0。
  2. FFT变换：对\( a_i[k] \)做FFT，得到频谱\( A_i(f) \)。
  3. 提取特征频率幅值：根据\( ft_i \)，计算\( F_{f,i}^{\text{BPFO}} \)、\( F_{f,i}^{\text{BPFI}} \)或\( F_{f,i}^{\text{BSF}} \)，健康样本取所有特征频率幅值的最小值。
  4. 计算谐波总能量：根据\( ft_i \)，计算\( E_{\text{harmonic},i} = \sum_{k=1}^3 |A_i(k \cdot \text{FF}_i)| \)，健康样本取0。

#### 步骤5：时频特征计算（对应时频特征提取模型）
- **输入**：补充属性后的\( \mathcal{S}' \)、每个样本的\( a_i[k] \)。
- **操作**：
  1. EMD分解：对\( a_i[k] \)进行EMD分解，得到8个IMF和1个趋势项，舍弃趋势项，保留前6个IMF。
  2. 计算IMF能量：\( E_{j,i} = \sum_{k=1}^{48000} |\text{imf}_{j,i}[k]|^2 \)（\( j=1~6 \)）。
  3. 计算能量占比：\( F_{\text{emd},j,i} = \frac{E_{j,i}}{\sum_{m=1}^6 E_{m,i}} \)（\( j=1~6 \)）。

#### 步骤6：特征矩阵构建（对应特征矩阵模型）
- **输入**：每个样本的时域特征（5维）、频域特征（4维）、时频特征（6维）。
- **操作**：将多域特征组合为15维向量\( \mathbf{f}_i \)（如\( \mathbf{f}_i = [\text{Peak}_i, \text{RMS}*i, ..., F*{\text{emd},6,i}]^T \)），形成161×15的源域特征矩阵。

#### 步骤7：特征选择（对应特征选择模型）
- **输入**：源域特征矩阵、样本的\( ft_i \)（故障类型标签）。
- **操作**：
  1. 初始化特征权重：\( W(f)=0 \)（\( f=1~15 \)）。
  2. 随机选取50个样本（覆盖所有故障类型），对每个样本：a. 找5个同类近邻（故障类型相同、特征距离最近）和5个异类近邻（故障类型不同、特征距离最近）。b. 更新权重：\( W(f) = W(f) - \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{h,l}(f)| + \frac{1}{50 \times 5} \sum_{l=1}^5 |x_i(f) - x_{m,l}(f)| \)。
  3. 按权重降序排序，选取前10个特征作为有效特征子集。

#### 步骤8：输出内容整理
- **输出**：
  1. 筛选后的源域数据集\( \mathcal{S}' \)（含补充的\( f_r \)、\( n \)、\( d \)、\( D \)字段）；
  2. 代表性样本的特征分析（时域、频域、时频特征的统计分布）；
  3. 161×15的源域特征矩阵；
  4. ReliefF算法筛选的有效特征子集（前10个高权重特征）。

以上步骤严格遵循数学模型的输入约束与公式推导，算法与模型完全适配，确保特征提取的有效性与可复现性，为后续跨域故障诊断的迁移任务提供核心支撑。
